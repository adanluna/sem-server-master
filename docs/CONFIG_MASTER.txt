CONFIGURACIÃ“N DEL PROYECTO SEMEFO (SERVER MASTER)
=================================================

1. ESTRUCTURA DE DIRECTORIOS
-------------------------------------------------
/opt/semefo
â”œâ”€â”€ api-server/
â”‚   â”œâ”€â”€ database.py
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ schemas.py
â”œâ”€â”€ config-scripts/
â”‚   â”œâ”€â”€ api.sql
â”‚   â””â”€â”€ crear_usuario_db.sql
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ docs/
â”œâ”€â”€ logs/
â”œâ”€â”€ backups/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ backup_db.sh
â”‚   â”œâ”€â”€ detener_workers_master.sh
â”‚   â”œâ”€â”€ iniciar_workers_master.sh
â”‚   â”œâ”€â”€ iniciar_workers.sh
â”‚   â”œâ”€â”€ detener_workers.sh
â”‚   â””â”€â”€ rebuild_docker.sh
â””â”€â”€ worker/
    â”œâ”€â”€ celery_app.py
    â”œâ”€â”€ db_utils.py
    â”œâ”€â”€ job_api_client.py
    â”œâ”€â”€ Dockerfile
    â”œâ”€â”€ requirements.txt
    â””â”€â”€ tasks.py

2. CREAR Y CONFIGURAR BASE DE DATOS
-------------------------------------------------
docker compose up -d db rabbitmq
sudo chmod +x /opt/semefo/config-scripts/crear_db_desde_env.sh
./opt/semefo/config-scripts/crear_db_desde_env.sh
docker exec -i postgres_db psql -U semefo_user -d semefo < config-scripts/api.sql

3. CONFIGURAR RABBITMQ
-------------------------------------------------
docker exec -it rabbitmq bash
rabbitmqctl add_user semefo_admin pass_admin
rabbitmqctl set_permissions -p / semefo_admin ".*" ".*" ".*"
rabbitmqctl set_user_tags semefo_admin administrator
exit

4. VERIFICAR
-------------------------------------------------
docker ps
sudo systemctl status semefo-master
API â†’ http://192.168.1.11:8000/docs
RabbitMQ UI â†’ http://192.168.1.11:15672
PostgreSQL â†’ docker exec -it postgres_db psql -U semefo_user -d semefo

5. REINICIO DEL SISTEMA
-------------------------------------------------
sudo systemctl restart semefo-master

ðŸ§  NOTA: Los scripts de backup (2 AM) y reinicio de workers (3 AM) se ejecutan automÃ¡ticamente mediante cron.
